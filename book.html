<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>

    <style>
        * {
            margin: 0;
            padding: 0;
        }

        body {
            background-color: #F0F1F3;
            user-select: none;
        }

        .main {
            display: flex;
            align-items: center;
            flex-direction: column;
            padding: 0;
            margin: 0;
            list-style-type: none;
            justify-content: center;
            padding-bottom: 1.5rem;
            padding-left: 15px;
            padding-right: 15px;
            font-size: 15px;
            font-weight: 400;


        }

        .main>* {
            background-color: #FFFFFF;
            /* Apply background color to the content */
            width: calc(100% - 30px);
            /* Subtract 15px from left and right */
            padding-left: 15px;
            padding-right: 15px;
            /* box-shadow: 0 8px 6px rgba(0, 0, 0, 0.1),0 -54px 8px rgba(0, 0, 0, 0.1),4px 0 8px rgba(0, 0, 0, 0.1); */


        }

        #price {
            /* box-shadow: 0 8px 6px rgba(0, 0, 0, 0.1); */
        }

        .main img {
            /* box-shadow: 0 -9px 8px rgba(0, 0, 0, 0.1); */
            padding-top: 20px;

            box-shadow: -3px 5px 5px rgba(0, 0, 0, 0.15), 3px 5px 5px rgba(0, 0, 0, 0.15), 0px -10px 10px rgba(0, 0, 0, 0.2);


            /* box-shadow: 4px 0 8px rgba(0, 0, 0, 0.1),-4px 0 8px rgba(0, 0, 0, 0.3); */
        }

        .main span,
        hr {
            box-shadow: -3px 5px 5px rgba(0, 0, 0, 0.15), 3px 5px 5px rgba(0, 0, 0, 0.15);
        }

        .h11 {
            text-align: center;
            margin-top: 15px;

        }

        .h1 {
            text-align: center;
            padding-top: 18px;
            padding-bottom: 10px;
        }

        h2 {
            display: inline;
            color: #0397d3;
            margin-left: 3px;
        }

        #price {
            text-align: center;
            padding-top: 8px;

            padding-bottom: 26px;
        }

        .cart {
            width: 100%;
            height: 90px;
            background-color: white;
            position: fixed;
            bottom: 0;
            box-shadow: 0px -10px 10px rgba(0, 0, 0, 0.1);
            display: flex;
            justify-content: center;
            /* Center horizontally */
            align-items: center;
        }

        .btn {
            width: 92%;
            height: 70px;
            background-color: #0071E3;
            border-radius: 4px;
            display: flex;
            justify-content: center;
            /* Center horizontally */
            align-items: center;
        }


        #h3 {
            display: flex;
            align-items: center;
            /* Vertically align text with the image */
            margin: 0;
            /* Remove default margin */
        }

        #h3 img {
            margin-right: 10px;
            /* Space between the image and text */
            color: #FFFFFF;
        }
    </style>

<style>
    /* footer only */
    .footer {
            width: 100%;
            height: 3.8rem;
            background-color: rgb(255, 255, 255);
            position: fixed;
            bottom: 0;
            display: flex;
            flex-direction: row;
            justify-content: center;
            /* Horizontally center the items */
            align-items: center;
            box-shadow: 0px -10px 10px rgba(0, 0, 0, 0.1);



        }

        #hm,
        .cartt,#ac {
            width: 33%;
            justify-content: center;
        }

        .cartt {
            display: inline-flex;
            align-items: flex-start;
            justify-content: center;
        }


        #rd {
            color: rgb(255 255 255);
            font-weight: 700;

            background-color: rgb(255 78 99);



            color: white;
            font-size: 12px;
            font-weight: bold;
            width: 18px;
            height: 18px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            margin-left: -10px;
            /* Adjusts overlap with the SVG */
            margin-top: -5px;
            /* Moves badge upwards */
            box-shadow: 0px 0px 3px rgba(0, 0, 0, 0.3);
            z-index: 1;
            /* Ensures the badge is above the SVG */


        }


        #hm {
            opacity: .5;
            justify-content: center;
            text-align: center;
        }

        #cartt00 {
          
            justify-content: center;
            text-align: center;
        }
        #ac {
            opacity: .5;
        }

        body,
        html {
            overflow-x: hidden;
        }

  /* footer only */
</style>

</head>

<body>

    <div class="footer">

        <svg id="hm" xmlns="http://www.w3.org/2000/svg" width="18px" height="20px" viewBox="0 0 17.996 20.442">
            <path
                d="M48.187,7.823,39.851.182A.7.7,0,0,0,38.9.2L31.03,7.841a.7.7,0,0,0-.211.5V19.311a.694.694,0,0,0,.694.694H37.3A.694.694,0,0,0,38,19.311V14.217h3.242v5.095a.694.694,0,0,0,.694.694h5.789a.694.694,0,0,0,.694-.694V8.335a.7.7,0,0,0-.228-.512ZM47.023,18.617h-4.4V13.522a.694.694,0,0,0-.694-.694H37.3a.694.694,0,0,0-.694.694v5.095H32.2V8.63l7.192-6.98L47.02,8.642v9.975Z"
                transform="translate(-30.619 0.236)" fill="black" stroke="currentColor" stroke-width="0.4"></path>
        </svg>

        <div id="cartt00" class="cartt">

            <svg id="cartt0" width="32" height="32" viewBox="0 0 32 32" fill="none"
                class="text-opacity-100 brightness-0" xmlns="http://www.w3.org/2000/svg">
                <path
                    d="M11.5 11.67V10.7C11.5 8.45001 13.31 6.24001 15.56 6.03001C18.24 5.77001 20.5 7.88001 20.5 10.51V11.89"
                    stroke="#000000" stroke-width="1.5" stroke-miterlimit="10" stroke-linecap="round"
                    stroke-linejoin="round"></path>
                <path
                    d="M12.9998 26H18.9998C23.0198 26 23.7398 24.39 23.9498 22.43L24.6998 16.43C24.9698 13.99 24.2698 12 19.9998 12H11.9998C7.72983 12 7.02983 13.99 7.29983 16.43L8.04983 22.43C8.25983 24.39 8.97983 26 12.9998 26Z"
                    stroke="#000000" stroke-width="1.5" stroke-miterlimit="10" stroke-linecap="round"
                    stroke-linejoin="round"></path>
                <path d="M19.4955 16H19.5045" stroke="#000000" stroke-width="2" stroke-linecap="round"
                    stroke-linejoin="round"></path>
                <path d="M12.4945 16H12.5035" stroke="#000000" stroke-width="2" stroke-linecap="round"
                    stroke-linejoin="round"></path>
            </svg>
            <span id="rd">?</span>


        </div>

        <svg id="ac" xmlns="http://www.w3.org/2000/svg"   height="32" fill="black" class="bi bi-person" viewBox="0 0 16 16">
            <path d="M8 8a3 3 0 1 0 0-6 3 3 0 0 0 0 6m2-3a2 2 0 1 1-4 0 2 2 0 0 1 4 0m4 8c0 1-1 1-1 1H3s-1 0-1-1 1-4 6-4 6 3 6 4m-1-.004c-.001-.246-.154-.986-.832-1.664C11.516 10.68 10.289 10 8 10s-3.516.68-4.168 1.332c-.678.678-.83 1.418-.832 1.664z"/>
          </svg>

    </div>
  

    <div id="main0" class="main0">

    </div>


    <div class="cart">

        <div class="btn" onclick="cart()">
            <h3 id="h3"> <img src="https://www.rokomari.com/static/200/images/cart-info.png" alt=""> Add to Cart</h3>
        </div>
    </div>

    <script>

        document.getElementById("hm").onclick = function () {
            window.location.href = './1.html';
        }
    
        document.getElementById("cartt00").onclick = function () {
            window.location.href = './cart.html';
    
    }
    document.getElementById("ac").onclick = function () {
            window.location.href = './ac.html';
        }
    
    </script>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.6.0/firebase-app.js";

        import { getFirestore, collection, addDoc, query, orderBy, limit, getDocs, getDoc, where, setDoc, Timestamp, updateDoc, doc, arrayUnion } from "https://www.gstatic.com/firebasejs/10.6.0/firebase-firestore.js";



        const firebaseConfig1 = {
            apiKey: "AIzaSyBzaFL1XOU-_152duOo0baL1DfgVVuSwMI",
            authDomain: "test2-5bbd8.firebaseapp.com",
            databaseURL: "https://test2-5bbd8-default-rtdb.asia-southeast1.firebasedatabase.app",
            projectId: "test2-5bbd8",
            storageBucket: "test2-5bbd8.appspot.com",
            messagingSenderId: "683307239625",
            appId: "1:683307239625:web:d28ed1c2fb6b31dd4e6518"
        };


        const app1 = initializeApp(firebaseConfig1);


        const firestore = getFirestore(app1);



        window.book = async function () {
            const urlParams = new URLSearchParams(window.location.search);

            // Retrieve the 'id' query parameter
            const id = urlParams.get('id');

            const usersRef = collection(firestore, "boiList");

            // Document reference
            const docRef = doc(usersRef, id);

            // Get the document
            const doc3 = await getDoc(docRef);

            if (doc3.exists()) {
                // Document exists, retrieve data
                console.log(doc3.data());
                let data = doc3.data()


                let node = document.createElement('div')

                node.setAttribute('class', 'main')
                node.innerHTML = `
 
        <img src=${data.img} width="300px" height="auto" alt="">
        <span><h1 class="h11">${data.title}</h1> </span>
        <span class="h1"> by <h2>${data.author}</h2> </span>
        <hr>
        <span id="price"><h1>  ${data.price}</h1></span>
    

    
    `


                let ul = document.getElementById("main0");
                ul.appendChild(node);









            } else {
                // Document does not exist
                console.log('No such document!');
                alert("Book sold OUt")
            }
        };
        book()


        window.cart = async function () {
            // alert(4)
            // const usersRef = collection(firestore, "boiUser");
            //         const q = query(usersRef, where("gmail", "==", gmail));
            //         const querySnapshot = await getDocs(q);

            if (getCookie("boiEmail") != undefined) {
                const usersRef = collection(firestore, "boiUser");
                const q = query(usersRef, where("gmail", "==", getCookie("boiEmail")));
                const querySnapshot = await getDocs(q);
                const userDoc = querySnapshot.docs[0];
                console.log(userDoc.data())


                const userRef = doc(firestore, "boiUser", userDoc.id);

                const urlParams = new URLSearchParams(window.location.search);

// Retrieve the 'id' query parameter
const id = urlParams.get('id');
                const currentData = userDoc.data().cart || [];
                currentData.push(id);


                await updateDoc(userRef, {
                    "cart": currentData  // Add new status value to the array
                });




            } else {
                alert("Log in plz")
            }

        }



        window.getCookie = function (name) {
            const value = `; ${document.cookie}`;
            const parts = value.split(`; ${name}=`);
            if (parts.length === 2) return parts.pop().split(';').shift();
        }

        // Retrieve the values
        console.log(getCookie("boiEmail")); // Outputs: Zayn

    </script>
</body>

</html>